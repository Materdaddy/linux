From 666e64a5c7ba5d20b65aa00d11670e5049859118 Mon Sep 17 00:00:00 2001
From: Alan Tull <r80115@freescale.com>
Date: Tue, 28 Apr 2009 12:17:21 -0500
Subject: [PATCH] ENGR00111971 mx37: allocate wm8350 irq

- Allocate irq for wm8350
- Cleanup build warnings

Signed-off-by: Alan Tull <r80115@freescale.com>
---
 arch/arm/mach-mx37/mx37_3stack.c             |    3 ++-
 arch/arm/mach-mx37/mx37_3stack_gpio.c        |    2 --
 arch/arm/mach-mx37/mx37_3stack_pmic_wm8350.c |    4 +++-
 3 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/arch/arm/mach-mx37/mx37_3stack.c b/arch/arm/mach-mx37/mx37_3stack.c
index a448e85..fa43cfd 100644
--- a/arch/arm/mach-mx37/mx37_3stack.c
+++ b/arch/arm/mach-mx37/mx37_3stack.c
@@ -550,11 +550,12 @@ static void mxc_unifi_hardreset(int pin_level)
 
 	if (board_is_mx37(BOARD_REV_2)) {
 		gpo4 = regulator_get(NULL, "GPO4");
-		if (!IS_ERR(gpo4))
+		if (!IS_ERR(gpo4)) {
 			if (pin_level & 0x01)
 				regulator_enable(gpo4);
 			else
 				regulator_disable(gpo4);
+		}
 		regulator_put(gpo4);
 	} else {
 		mxc_request_iomux(MX37_PIN_AUD5_RXC, IOMUX_CONFIG_GPIO);
diff --git a/arch/arm/mach-mx37/mx37_3stack_gpio.c b/arch/arm/mach-mx37/mx37_3stack_gpio.c
index a94f73c..f8e1ce8 100644
--- a/arch/arm/mach-mx37/mx37_3stack_gpio.c
+++ b/arch/arm/mach-mx37/mx37_3stack_gpio.c
@@ -342,8 +342,6 @@ EXPORT_SYMBOL(gpio_activate_audio_ports);
  */
 void gpio_sdhc_active(int module)
 {
-	unsigned int pad_val;
-
 	switch (module) {
 	case 0:
 		mxc_request_iomux(MX37_PIN_SD1_CLK,
diff --git a/arch/arm/mach-mx37/mx37_3stack_pmic_wm8350.c b/arch/arm/mach-mx37/mx37_3stack_pmic_wm8350.c
index 9a6c793..cc74bd3 100644
--- a/arch/arm/mach-mx37/mx37_3stack_pmic_wm8350.c
+++ b/arch/arm/mach-mx37/mx37_3stack_pmic_wm8350.c
@@ -25,6 +25,8 @@
 #include <linux/mfd/wm8350/gpio.h>
 #include <linux/mfd/wm8350/bl.h>
 
+#include "iomux.h"
+
 /* CPU */
 static struct regulator_consumer_supply dcdc1_consumers[] = {
 	{
@@ -253,7 +255,7 @@ struct wm8350_platform_data __initdata mx37_wm8350_pdata = {
 static struct i2c_board_info __initdata wm8350_i2c_device = {
 	I2C_BOARD_INFO("wm8350", 0x1a),
 	.platform_data = &mx37_wm8350_pdata,
-//	.irq = IOMUX_TO_IRQ(MX31_PIN_GPIO1_3),
+	.irq = IOMUX_TO_IRQ(MX37_PIN_GPIO1_4),
 };
 
 static __init int mxc_init_i2c(void)
-- 
1.5.4.4

