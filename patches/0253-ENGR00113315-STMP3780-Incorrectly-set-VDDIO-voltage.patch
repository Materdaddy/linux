From 045c414f5788b594ebe978c86e06b566bbe210ca Mon Sep 17 00:00:00 2001
From: Nancy Chen <Nancy.Chen@freescale.com>
Date: Fri, 12 Jun 2009 12:14:10 -0500
Subject: [PATCH] ENGR00113315 STMP3780: Incorrectly set VDDIO voltage

STMP3780: Incorrectly set VDDIO voltage.

Signed-off-by: Nancy Chen <Nancy.Chen@freescale.com>
---
 arch/arm/mach-stmp3xxx/power.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-stmp3xxx/power.c b/arch/arm/mach-stmp3xxx/power.c
index 7a49574..416e567 100644
--- a/arch/arm/mach-stmp3xxx/power.c
+++ b/arch/arm/mach-stmp3xxx/power.c
@@ -506,8 +506,9 @@ static int __init regulators_init(void)
 {
 	int i;
 	int retval = 0;
+	u32 vddio = HW_POWER_VDDIOCTRL_RD() & ~0x1f;
 	pr_debug("regulators_init \n");
-	HW_POWER_VDDIOCTRL_WR(0x00022614);
+	HW_POWER_VDDIOCTRL_WR(vddio | 0x14);
 	vdddbo_reg.parent = &vddd_reg;
 	stmp3xxx_register_regulator(&vddd_reg, STMP3XXX_VDDD, &vddd_init);
 	stmp3xxx_register_regulator(&vdddbo_reg, STMP3XXX_VDDDBO, &vdddbo_init);
-- 
1.5.4.4

